#!/usr/bin/env ruby

class Interface
  def welcome
    puts '* * *                         * * *'
    puts '*                                 *'
    puts '*     Welcome to Tic Tac Toe!     *'
    puts '                                   '
    puts '               | X | O             '
    puts '            ---+---+---            '
    puts '             O | X | X             '
    puts '            ---+---+---            '
    puts '               | O |               '
    puts '                                   '
    puts '*     Press "Enter" to start!     *'
    puts '*                                 *'
    puts '* * *                         * * *'
    @enter = gets.chomp
    until @enter == ''
      puts 'Do not enter any value!'
      @enter = gets.chomp
    end
  end

  def actual_board
    puts
    puts '* *        Actual board:        * *'
    puts '*                                 *'
    puts '             1 | 2 | 3             '
    puts '            ---+---+---            '
    puts '             4 | 5 | 6             '
    puts '            ---+---+---            '
    puts '*            7 | 8 | 9            *'
    puts '* *                             * *'
    puts
    puts 'Available positions: 1 2 3 4 5 6 7 8 9'
    puts
  end

  def play_again
    puts '* *                             * *'
    puts '*     Enter "A" to play again     *'
    puts '       ---------------------       '
    puts '*        Enter "E" to exit        *'
    puts '* *                             * *'
  end
end

class GameInterface < Interface
  def initialize
    @random_turn = (rand * 10).to_i
  end

  def players
    print 'Enter player one: '
    @player_one = gets.chomp.capitalize
    puts "Player \"#{@player_one}\" plays with X's!", ''
    print 'Enter player two: '
    @player_two = gets.chomp.capitalize
    until @player_two != @player_one
      puts 'Choose a different name please!'
      @player_two = gets.chomp.capitalize
    end
    puts "Player \"#{@player_two}\" plays with O's!", ''
  end

  def who_moves_first
    @first_move = @player_one if @random_turn.even?
    @first_move = @player_two if @random_turn.odd?
    puts "#{@first_move} goes first!"
  end

  def moves
    puts "Choose a position #{@first_move}: "
    @chosen_move = gets.chomp
  end

  def win
    @winner = @first_move
    puts "You win #{@winner}"
  end

  def play_again_logic
    play_again
    @desition = gets.chomp.upcase
    case @desition
    when 'A'
      hola = GameInterface.new
      hola.welcome
      hola.players
      hola.actual_board
      hola.who_moves_first
      hola.moves
      hola.win
      hola.play_again
    when 'E'
      puts 'Thank you for playing! :D'
    else
      puts 'Enter the correct value please'
      gets.chomp
    end
  end
end

hola = GameInterface.new
hola.welcome
hola.players
hola.actual_board
hola.who_moves_first
hola.moves
hola.win
hola.play_again_logic
